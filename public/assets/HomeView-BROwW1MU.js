import{l as L,p as P,u as Y,B as Z}from"./BaseLayout-PGp4N0kt.js";import{I as H}from"./IconUser-NTJCc5Id.js";import{_ as p,x as r,g as o,h as n,d as B,f as q,e as b,z as I,u as k,i as f,t as l,w as G,k as S,o as g,l as E,v as U,s as h,m as w,A as $,F as T,B as C,q as R,n as x,r as j}from"./index-BWxaOGrR.js";import{M as V,I as K,F as A,S as J}from"./SuccessToast--H6gjP7X.js";const ee={},se={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function te(e,s){return r(),o("svg",se,s[0]||(s[0]=[n("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"},null,-1)]))}const Q=p(ee,[["render",te]]),ne={},ie={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function re(e,s){return r(),o("svg",ie,s[0]||(s[0]=[n("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},null,-1)]))}const ae=p(ne,[["render",re]]),oe={},de={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function le(e,s){return r(),o("svg",de,s[0]||(s[0]=[n("path",{d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"},null,-1)]))}const ue=p(oe,[["render",le]]),D=B("requestSend",{state:()=>({loaded:!1,requests:[]}),getters:{numSendRequests:e=>e.requests.length??0,isLoaded:e=>e.loaded,sendRequests:e=>e.requests},actions:{loadRequests(){return new Promise((e,s)=>{q.get("/api/resources/sended-friend-requests").then(t=>{var d;this.requests=((d=t.data)==null?void 0:d.sendedRequests)??[],this.loaded=!0,e(!0)}).catch(t=>{t.response.status==401?s(401):s(t)})})},sendRequest(e){return new Promise((s,t)=>{q.post("/api/resources/friend-request-send",e).then(d=>{var a;this.requests=((a=d.data)==null?void 0:a.sendedRequests)??[],s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})},cancelFrienRequest(e){return new Promise((s,t)=>{q.post("/api/resources/friend-request-delete",e).then(d=>{var a;this.requests=((a=d.data)==null?void 0:a.sendedRequests)??[],s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})},editFriendRequest(e){return new Promise((s,t)=>{q.post("/api/resources/friend-request-edit",e).then(d=>{var a;this.requests=((a=d.data)==null?void 0:a.sendedRequests)??[],s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})}}}),M=B("requestGet",{state:()=>({loaded:!1,requests:[]}),getters:{numGetRequests:e=>e.requests.length??0,isLoaded:e=>e.loaded,getRequests:e=>e.requests},actions:{loadRequests(){return new Promise((e,s)=>{q.get("/api/resources/received-friend-requests").then(t=>{var d;this.requests=((d=t.data)==null?void 0:d.receivedRequests)??[],this.loaded=!0,e(!0)}).catch(t=>{t.response.status==401?s(401):s(t)})})},acceptRequest(e){return new Promise((s,t)=>{q.post("/api/resources/friend-request-accept",e).then(d=>{var a;this.requests=((a=d.data)==null?void 0:a.receivedRequests)??[],s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})},denieRequest(e){return new Promise((s,t)=>{q.post("/api/resources/friend-request-denie",e).then(d=>{var a;this.requests=((a=d.data)==null?void 0:a.receivedRequests)??[],s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})}}}),z=B("friends",{state:()=>({friends:[],groups:[]}),getters:{numFriends:e=>e.friends.length??0,numGroups:e=>e.groups.length??0,allFriends:e=>e.friends,allGroups:e=>e.groups,getFriendData:e=>s=>e.friends.find(t=>t.friendId==s)},actions:{loadFriends(){return new Promise((e,s)=>{q.get("/api/resources/friends").then(t=>{var d,a;this.friends=((d=t.data)==null?void 0:d.friends)??[],this.groups=((a=t.data)==null?void 0:a.groups)??[],e(!0)}).catch(t=>{console.log(t),t.response.status==401?s(401):s(t)})})},createGroup(e){return new Promise((s,t)=>{q.post("/api/resources/create-group",e).then(()=>{s(!0)}).catch(d=>{d.response.status==401?t(401):t(d)})})}}}),ce={props:{friend:{type:Object,default(e){return{friendId:null,friendName:"",friendDescription:"",friendCountry:"",friendCity:"",friendImg:null,reqId:null,reqAcceptedDate:null,sendId:null,sendAcceptedDate:null,messageToFriend:"",messageFromFriend:""}}}},components:{IconUser:H,Modal:V,IconEdit:K},data(){return{showDetails:!1,sending:!1,showRequestModal:!1,requestText:"",editing:!1}},computed:{...b(k,["lg"]),hasFriend(){return this.friend.friendId!=null},isFriend(){return this.friend.reqId&&this.friend.reqAcceptedDate||this.friend.sendId&&this.friend.sendAcceptedDate},isReqGet(){return this.friend.reqId&&!this.friend.reqAcceptedDate},isReqSend(){return this.friend.sendId&&!this.friend.sendAcceptedDate}},methods:{...I(D,["sendRequest","cancelFrienRequest","editFriendRequest"]),...I(M,["acceptRequest","denieRequest"]),modalClose(){this.showDetails=!1},openModal(){this.showDetails=!0},openRequestModal(){this.requestText="",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus()},300)},sendFriendRequest(){this.editing?(this.showRequestModal=!1,this.sending=!0,this.editFriendRequest({requestId:this.friend.sendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.friend.messageToFriend=this.requestText,this.editing=!1,this.showDetails=!0}).catch(e=>{this.sending=!1,this.editing=!1,e==401&&this.$router.push("/login")})):(this.showRequestModal=!1,this.sending=!0,this.sendRequest({friendId:this.friend.friendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.$emit("reloadData","SUCCESS",this.lg("frind_request_send"))}).catch(e=>{this.sending=!1,e==401?this.$router.push("/login"):this.$emit("reloadData","ERROR",this.lg("frind_request_send_fail"))}))},acceptFriendRequest(){this.sending=!0,this.acceptRequest({requestId:this.friend.reqId}).then(()=>{this.sending=!1,this.$emit("reloadData","SUCCESS",this.lg("frien_request_accepted"))}).catch(e=>{this.sending=!1,e==401?this.$router.push("/login"):this.$emit("reloadData","ERROR",this.lg("general_error"))})},denieFriendRequest(){this.sending=!0,this.denieRequest({requestId:this.friend.reqId}).then(()=>{this.sending=!1,this.$emit("reloadData","SUCCESS",this.lg("request_denited"))}).catch(e=>{this.sending=!1,e==401?this.$router.push("/login"):this.$emit("reloadData","ERROR",this.lg("general_error"))})},cancelRequest(){this.sending=!0,this.cancelFrienRequest({requestId:this.friend.sendId}).then(()=>{this.sending=!1,this.$emit("reloadData","SUCCESS",this.lg("request_canceled"))}).catch(e=>{this.sending=!1,e==401?this.$router.push("/login"):this.$emit("reloadData","ERROR",this.lg("general_error"))})},editRequestMessage(){this.showDetails=!1,this.editing=!0,this.requestText=this.friend.messageToFriend??"",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus().select()},300)},sendMessage(){}}},he={key:0,class:"friend-card"},ge={class:"friend-card-img"},fe=["src"],_e={key:1,class:"icon-lg"},me={class:"friend-card-action"},pe=["disabled"],be={key:1},qe=["disabled"],Se=["disabled"],Re={key:2},ve=["disabled"],Ie=["disabled"],ke={class:"text-left"},ye={class:"text-center mt-1 mb-2"},Te=["src"],Ce={key:1,class:"icon-lg"},we={class:"friend-modal-des"},Fe={class:"text-bold"},Ge={class:"text-bold"},Ee={class:"text-bold"},De={class:"mb-2"},Me={key:0},Ne={key:0},xe={key:1},ze={class:"mt-2 friend-card-btns"},Le=["disabled"],Pe=["disabled"],Be={key:1},Ue={key:0},Ae={key:1},Oe={class:"request-modal-body"},He={for:"request_text_input_field"};function Ve(e,s,t,d,a,i){const m=h("IconUser"),c=h("IconEdit"),v=h("Modal");return i.hasFriend?(r(),o("div",he,[n("div",ge,[t.friend.friendImg?(r(),o("img",{key:0,src:t.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,fe)):(r(),o("span",_e,[f(m)]))]),n("div",{class:"friend-card-name",onClick:s[0]||(s[0]=(...u)=>i.openModal&&i.openModal(...u))},[n("h5",null,l(t.friend.friendName),1)]),n("div",me,[i.isFriend?(r(),o("button",{key:0,class:"btn-sm btn-primary btn-block",onClick:s[1]||(s[1]=(...u)=>i.sendMessage&&i.sendMessage(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("send_message")),9,pe)):i.isReqGet?(r(),o("div",be,[n("button",{class:"btn-sm btn-primary btn-block",onClick:s[2]||(s[2]=(...u)=>i.acceptFriendRequest&&i.acceptFriendRequest(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("accept_request")),9,qe),n("button",{class:"btn-sm btn-danger btn-block",onClick:s[3]||(s[3]=(...u)=>i.denieFriendRequest&&i.denieFriendRequest(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("denie_request")),9,Se)])):i.isReqSend?(r(),o("div",Re,[n("p",null,l(e.lg("already_send")),1),n("button",{class:"btn-sm btn-danger btn-block",onClick:s[4]||(s[4]=(...u)=>i.cancelRequest&&i.cancelRequest(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("cancel_request")),9,ve)])):(r(),o("button",{key:3,class:"btn-sm btn-primary btn-block",onClick:s[5]||(s[5]=(...u)=>i.openRequestModal&&i.openRequestModal(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("send_request")),9,Ie))]),f(v,{show:a.showDetails,size:"md",title:t.friend.friendName,headerClass:"text-left",showFooter:!1,onClose:i.modalClose},{default:G(()=>[n("div",ke,[n("div",ye,[t.friend.friendImg?(r(),o("img",{key:0,src:t.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,Te)):(r(),o("span",Ce,[f(m)]))]),n("div",we,[n("p",null,[n("span",Fe,l(e.lg("city"))+" :",1),S(l(t.friend.friendCity??"????"),1)]),n("p",null,[n("span",Ge,l(e.lg("friend_country"))+" :",1),S(l(t.friend.friendCountry??"????"),1)]),n("p",null,[n("span",Ee,l(e.lg("friend_des"))+" :",1)]),n("p",De,l(t.friend.friendDescription??"??????"),1),i.isReqGet?(r(),o("div",Me,[n("p",null,l(e.lg("message")),1),t.friend.messageFromFriend?(r(),o("p",Ne,l(t.friend.messageFromFriend),1)):(r(),o("p",xe,l(e.lg("no_message")),1)),n("div",ze,[n("button",{class:"btn btn-primary",onClick:s[6]||(s[6]=(...u)=>i.acceptFriendRequest&&i.acceptFriendRequest(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("accept_request")),9,Le),n("button",{class:"btn btn-danger",onClick:s[7]||(s[7]=(...u)=>i.denieFriendRequest&&i.denieFriendRequest(...u)),disabled:a.sending},l(a.sending?e.lg("sending"):e.lg("denie_request")),9,Pe)])])):g("",!0),i.isReqSend?(r(),o("div",Be,[n("p",null,l(e.lg("you_request_text")),1),t.friend.messageToFriend?(r(),o("p",Ue,[S(l(t.friend.messageToFriend)+" ",1),n("span",{class:"icon-edit-btn ml-1",onClick:s[8]||(s[8]=(...u)=>i.editRequestMessage&&i.editRequestMessage(...u))},[f(c)])])):(r(),o("p",Ae,[S(l(e.lg("no_request_send_text"))+" ",1),n("span",{class:"icon-edit-btn ml-1",onClick:s[9]||(s[9]=(...u)=>i.editRequestMessage&&i.editRequestMessage(...u))},[f(c)])]))])):g("",!0)])])]),_:1},8,["show","title","onClose"]),f(v,{show:a.showRequestModal,size:"sm",title:e.lg("send_request"),headerClass:"text-left",showCancel:!0,cancelBtnText:e.lg("cancel"),okBtnText:e.lg("send"),onClose:s[11]||(s[11]=u=>a.showRequestModal=!1),onCancel:s[12]||(s[12]=u=>a.showRequestModal=!1),onOk:i.sendFriendRequest},{default:G(()=>[n("div",Oe,[n("p",null,[S(l(e.lg("addresse"))+" ",1),n("span",null,l(t.friend.friendName),1)]),n("label",He,l(e.lg("few_words")),1),E(n("textarea",{name:"requestText",id:"request_text_input_field","onUpdate:modelValue":s[10]||(s[10]=u=>a.requestText=u)},null,512),[[U,a.requestText]])])]),_:1},8,["show","title","cancelBtnText","okBtnText","onOk"])])):g("",!0)}const O=p(ce,[["render",Ve]]),Ke={components:{IconSearch:Q,FailToast:A,FriendCard:O},data(){return{submitting:!1,searchText:"",firstSearch:!0,searchResult:[],searchError:!1,paginationIndex:0}},computed:{...b(k,["lg"]),...w(P,L),hasSearchResult(){return this.searchResult.length>0},hasPagination(){return this.searchResult.length>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.searchResult.length},cardsToShow(){let e=[];if(!this.hasSearchResult)return e;let s=this.paginationIndex*this.paginationSizesStore.topSize;s>this.searchResult.length-1&&(s=this.searchResult.length-1),this.paginationSizesStore.topSize>=this.searchResult.length&&(s=0);let t=s+this.paginationSizesStore.topSize;t>this.searchResult.length&&(t=this.searchResult.length);for(let d=s;d<t;d++)e.push(this.searchResult[d]);return e}},methods:{searchUsers(){this.searchText.trim()!=""&&(this.firstSearch=!1,this.submitting=!0,this.loadingStore.startLoading(),this.searchError=!1,q.get("/api/resources/search-user?un="+this.searchText.trim()).then(e=>{this.submitting=!1,this.loadingStore.finishLoading(),this.searchResult=e.data.users}).catch(e=>{this.submitting=!1,this.loadingStore.finishLoading(),this.searchError=!0,setTimeout(()=>{this.searchError=!1},3e3),console.log(e)}))},paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++},reloadData(e,s){this.$emit("reloadData",e,s)}},mounted(){this.submitting=!1,this.searchText="",this.firstSearch=!0,document.getElementById("search_input").focus()}},Je={class:"search-menu"},Qe={class:"user-search-input"},We={for:"search_input"},Xe={class:"password-container"},Ye=["disabled"],Ze=["disabled"],$e={class:"icon"},je={key:0,class:"search-result-holder"},es={class:"results"},ss={key:0},ts=["disabled"],ns={class:"result-cards"},is={key:1},rs=["disabled"],as={key:1,class:"search-result-no-result-holder"},os={key:0},ds={key:1};function ls(e,s,t,d,a,i){const m=h("IconSearch"),c=h("FriendCard"),v=h("FailToast");return r(),o("div",null,[n("div",Je,[n("div",Qe,[n("label",We,l(e.lg("user_search")),1),n("div",Xe,[E(n("input",{id:"search_input",type:"text","onUpdate:modelValue":s[0]||(s[0]=u=>a.searchText=u),disabled:a.submitting,onKeypress:s[1]||(s[1]=$((...u)=>i.searchUsers&&i.searchUsers(...u),["enter"]))},null,40,Ye),[[U,a.searchText]]),n("button",{type:"button",onClick:s[2]||(s[2]=(...u)=>i.searchUsers&&i.searchUsers(...u)),disabled:a.submitting},[n("span",$e,[f(m)])],8,Ze)])])]),n("div",null,[i.hasSearchResult?(r(),o("div",je,[n("p",null,[n("span",null,l(a.searchResult.length),1),s[5]||(s[5]=S()),n("span",null,l(e.lg("results")),1)]),n("div",es,[i.hasPagination?(r(),o("div",ss,[n("button",{type:"button",disabled:a.paginationIndex==0,class:"pag-btn",onClick:s[3]||(s[3]=(...u)=>i.paginateLeft&&i.paginateLeft(...u))},"<",8,ts)])):g("",!0),n("div",ns,[(r(!0),o(T,null,C(i.cardsToShow,u=>(r(),R(c,{key:"friend_"+u.friendId,friend:u,onReloadData:i.reloadData},null,8,["friend","onReloadData"]))),128))]),i.hasPagination?(r(),o("div",is,[n("button",{type:"button",disabled:i.rightPaginationDisabled,class:"pag-btn",onClick:s[4]||(s[4]=(...u)=>i.paginateRight&&i.paginateRight(...u))},">",8,rs)])):g("",!0)])])):(r(),o("div",as,[a.firstSearch?(r(),o("p",os,l(e.lg("user_search_before")),1)):(r(),o("p",ds,l(e.lg("user_search_not_find")),1))]))]),a.searchError?(r(),R(v,{key:0})):g("",!0)])}const us=p(Ke,[["render",ls]]),cs={components:{FriendCard:O},data(){return{paginationIndex:0}},computed:{...b(k,["lg"]),...b(D,["numSendRequests","sendRequests"]),...w(P),hasPagination(){return this.numSendRequests>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.numSendRequests},cardsToShow(){let e=[];if(this.numSendRequests<1)return e;let s=this.paginationIndex*this.paginationSizesStore.topSize;s>this.sendRequests.length-1&&(s=this.sendRequests.length-1),this.paginationSizesStore.topSize>=this.sendRequests.length&&(s=0);let t=s+this.paginationSizesStore.topSize;t>this.sendRequests.length&&(t=this.sendRequests.length);for(let d=s;d<t;d++)e.push(this.sendRequests[d]);return e}},methods:{paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++},changeTabToSearch(){this.$emit("changeTab")},reloadData(e,s){this.$emit("reloadData",e,s)}}},hs={key:0,class:"search-result-holder"},gs={class:"results"},fs={key:0},_s=["disabled"],ms={class:"result-cards"},ps={key:1},bs=["disabled"],qs={key:1,class:"text-center m-2"};function Ss(e,s,t,d,a,i){const m=h("FriendCard");return r(),o("div",null,[e.numSendRequests?(r(),o("div",hs,[n("div",gs,[i.hasPagination?(r(),o("div",fs,[n("button",{type:"button",disabled:a.paginationIndex==0,class:"pag-btn",onClick:s[0]||(s[0]=(...c)=>i.paginateLeft&&i.paginateLeft(...c))},"<",8,_s)])):g("",!0),n("div",ms,[(r(!0),o(T,null,C(i.cardsToShow,c=>(r(),R(m,{key:"send__request_"+c.friendId,friend:c,onReloadData:i.reloadData},null,8,["friend","onReloadData"]))),128))]),i.hasPagination?(r(),o("div",ps,[n("button",{type:"button",disabled:i.rightPaginationDisabled,class:"pag-btn",onClick:s[1]||(s[1]=(...c)=>i.paginateRight&&i.paginateRight(...c))},">",8,bs)])):g("",!0)])])):(r(),o("div",qs,[n("p",null,[S(l(e.lg("not_send_any_request_yet"))+" ",1),n("span",{class:"btn-link",onClick:s[2]||(s[2]=(...c)=>i.changeTabToSearch&&i.changeTabToSearch(...c))},l(e.lg("contact_search")),1)])]))])}const Rs=p(cs,[["render",Ss]]),vs={components:{FriendCard:O},data(){return{paginationIndex:0}},computed:{...b(k,["lg"]),...b(M,["numGetRequests","getRequests"]),...w(P),hasPagination(){return this.numGetRequests>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.numGetRequests},cardsToShow(){let e=[];if(this.numGetRequests<1)return e;let s=this.paginationIndex*this.paginationSizesStore.topSize;s>this.getRequests.length-1&&(s=this.getRequests.length-1),this.paginationSizesStore.topSize>=this.getRequests.length&&(s=0);let t=s+this.paginationSizesStore.topSize;t>this.getRequests.length&&(t=this.getRequests.length);for(let d=s;d<t;d++)e.push(this.getRequests[d]);return e}},methods:{paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++},changeTabToSearch(){this.$emit("changeTab")},reloadData(e,s){this.$emit("reloadData",e,s)}}},Is={key:0,class:"search-result-holder"},ks={class:"results"},ys={key:0},Ts=["disabled"],Cs={class:"result-cards"},ws={key:1},Fs=["disabled"],Gs={key:1,class:"text-center m-2"};function Es(e,s,t,d,a,i){const m=h("FriendCard");return r(),o("div",null,[e.numGetRequests?(r(),o("div",Is,[n("div",ks,[i.hasPagination?(r(),o("div",ys,[n("button",{type:"button",disabled:a.paginationIndex==0,class:"pag-btn",onClick:s[0]||(s[0]=(...c)=>i.paginateLeft&&i.paginateLeft(...c))},"<",8,Ts)])):g("",!0),n("div",Cs,[(r(!0),o(T,null,C(i.cardsToShow,c=>(r(),R(m,{key:"send__request_"+c.friendId,friend:c,onReloadData:i.reloadData},null,8,["friend","onReloadData"]))),128))]),i.hasPagination?(r(),o("div",ws,[n("button",{type:"button",disabled:i.rightPaginationDisabled,class:"pag-btn",onClick:s[1]||(s[1]=(...c)=>i.paginateRight&&i.paginateRight(...c))},">",8,Fs)])):g("",!0)])])):(r(),o("div",Gs,[n("p",null,[S(l(e.lg("not_send_any_request_yet"))+" ",1),n("span",{class:"btn-link",onClick:s[2]||(s[2]=(...c)=>i.changeTabToSearch&&i.changeTabToSearch(...c))},l(e.lg("contact_search")),1)])]))])}const Ds=p(vs,[["render",Es]]),Ms={components:{IconUser:H,IconSearch:Q,IconLeft:ae,IconRight:ue,SearchContactTab:us,SendRequestsTab:Rs,GetRequestsTab:Ds,SuccessToast:J,FailToast:A},data(){return{selectedTab:"GET",saveSuccess:!1,saveError:!1,toastMessage:""}},computed:{...w(L),...b(k,["lg"]),...b(D,{numSendRequests:"numSendRequests",isSendStoreLoaded:"isLoaded"}),...b(M,{numGetRequests:"numGetRequests",isGetStoreLoaded:"isLoaded"})},methods:{...I(D,{loadSendRequests:"loadRequests"}),...I(M,{loadGetRequests:"loadRequests"}),...I(z,{loadFriends:"loadFriends"}),selectTab(e){e==this.selectedTab?this.selectedTab="NONE":this.selectedTab=e},loadStores(e="NONE",s=""){let t=[];this.isSendStoreLoaded||t.push(this.loadSendRequests()),this.isGetStoreLoaded||t.push(this.loadGetRequests()),t.push(this.loadFriends()),this.loadingStore.startLoading(),Promise.all(t).then(()=>{this.loadingStore.finishLoading(),this.numGetRequests>0?this.selectedTab="GET":this.selectedTab="NONE",e!=="NONE"&&(e==="SUCCESS"&&(this.toastMessage=s,this.saveSuccess=!0,setTimeout(()=>{this.saveSuccess=!1,this.toastMessage=""},3e3)),e==="ERROR"&&(this.toastMessage=s,this.saveError=!0,setTimeout(()=>{this.saveError=!1,this.toastMessage=""},3e3)))}).catch(d=>{this.loadingStore.finishLoading(),d==401?this.$router.push("/login"):(this.toastMessage=this.lg("general_error"),this.saveError=!0,setTimeout(()=>{this.saveError=!1,this.toastMessage=""},3e3))})}},mounted(){this.loadStores()}},Ns={class:"contact-tabs"},xs={class:"tab"},zs={class:"icon"},Ls={class:"icon"},Ps={class:"tab-text"},Bs={class:"icon"},Us={class:"icon"},As={class:"tab-text"},Os={key:0,class:"tab-num"},Hs={class:"icon"},Vs={class:"icon"},Ks={class:"tab-text"},Js={key:0,class:"tab-num"},Qs={key:0,class:"tab-content"},Ws={key:0},Xs={key:1},Ys={key:2};function Zs(e,s,t,d,a,i){const m=h("IconUser"),c=h("IconSearch"),v=h("IconLeft"),u=h("IconRight"),N=h("SearchContactTab"),_=h("GetRequestsTab"),y=h("SendRequestsTab"),W=h("SuccessToast"),X=h("FailToast");return r(),o("div",Ns,[n("div",xs,[n("span",{class:x(["tab-menu",{"active-tab":a.selectedTab=="SEARCH"}]),onClick:s[0]||(s[0]=F=>i.selectTab("SEARCH"))},[n("span",zs,[f(m)]),n("span",Ls,[f(c)]),n("span",Ps,l(e.lg("contact_search")),1)],2),n("span",{class:x(["tab-menu",{"active-tab":a.selectedTab=="GET"}]),onClick:s[1]||(s[1]=F=>i.selectTab("GET"))},[n("span",Bs,[f(m)]),n("span",Us,[f(v)]),n("span",As,l(e.lg("friend_requests")),1),e.numGetRequests?(r(),o("sup",Os,l(e.numGetRequests),1)):g("",!0)],2),n("span",{class:x(["tab-menu",{"active-tab":a.selectedTab=="SEND"}]),onClick:s[2]||(s[2]=F=>i.selectTab("SEND"))},[n("span",Hs,[f(m)]),n("span",Vs,[f(u)]),n("span",Ks,l(e.lg("send_requests")),1),e.numSendRequests?(r(),o("sup",Js,l(e.numSendRequests),1)):g("",!0)],2)]),a.selectedTab!="NONE"?(r(),o("div",Qs,[a.selectedTab=="SEARCH"?(r(),o("div",Ws,[f(N,{onReloadData:i.loadStores},null,8,["onReloadData"])])):g("",!0),a.selectedTab=="GET"?(r(),o("div",Xs,[f(_,{onChangeTab:s[3]||(s[3]=F=>i.selectTab("SEARCH")),onReloadData:i.loadStores},null,8,["onReloadData"])])):g("",!0),a.selectedTab=="SEND"?(r(),o("div",Ys,[f(y,{onChangeTab:s[4]||(s[4]=F=>i.selectTab("SEARCH")),onReloadData:i.loadStores},null,8,["onReloadData"])])):g("",!0)])):g("",!0),a.saveSuccess?(r(),R(W,{key:1,msg:a.toastMessage},null,8,["msg"])):g("",!0),a.saveError?(r(),R(X,{key:2,msg:a.toastMessage},null,8,["msg"])):g("",!0)])}const $s=p(Ms,[["render",Zs]]),js={props:{friends:Array},computed:{friendInitiative(){return e=>{let s=e.split(" "),t="";return s.forEach(d=>{d&&(t+=d.charAt(0))}),t?t.toUpperCase():"F"}}}},et={class:"friend-img"},st={key:0},tt={key:1},nt=["src"],it={key:1,class:"profile-init"},rt={key:2},at=["src"],ot={key:1,class:"profile-init"},dt=["src"],lt={key:3,class:"profile-init"},ut={key:3},ct=["src"],ht={key:1,class:"profile-init"},gt=["src"],ft={key:3,class:"profile-init"},_t=["src"],mt={key:5,class:"profile-init"},pt={key:6};function bt(e,s,t,d,a,i){return r(),o("div",et,[t.friends.length<1?(r(),o("span",st,s[0]||(s[0]=[n("span",null,"?",-1)]))):t.friends.length==1?(r(),o("span",tt,[t.friends[0].friendImg?(r(),o("img",{key:0,src:t.friends[0].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,nt)):(r(),o("span",it,l(i.friendInitiative(t.friends[0].friendName)),1))])):t.friends.length==2?(r(),o("span",rt,[t.friends[0].friendImg?(r(),o("img",{key:0,src:t.friends[0].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,at)):(r(),o("span",ot,l(i.friendInitiative(t.friends[0].friendName)),1)),t.friends[1].friendImg?(r(),o("img",{key:2,src:t.friends[1].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,dt)):(r(),o("span",lt,l(i.friendInitiative(t.friends[1].friendName)),1))])):(r(),o("span",ut,[t.friends[0].friendImg?(r(),o("img",{key:0,src:t.friends[0].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,ct)):(r(),o("span",ht,l(i.friendInitiative(t.friends[0].friendName)),1)),t.friends[1].friendImg?(r(),o("img",{key:2,src:t.friends[1].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,gt)):(r(),o("span",ft,l(i.friendInitiative(t.friends[1].friendName)),1)),t.friends[2].friendImg?(r(),o("img",{key:4,src:t.friends[2].friendImg,alt:"Profile Image",class:"profile-img sm"},null,8,_t)):(r(),o("span",mt,l(i.friendInitiative(t.friends[2].friendName)),1)),t.friends.length>3?(r(),o("b",pt," + "+l(t.friends.length-3),1)):g("",!0)]))])}const qt=p(js,[["render",bt]]),St={components:{Modal:V,ContactImage:qt,SuccessToast:J,FailToast:A,IconEdit:K},data(){return{showCreateGroupModal:!1,saveError:!1,saveSuccess:!1,newGroupName:"",missingGroupName:!1,selectedFriendsForNewGroup:[],noFriendSelected:!1}},computed:{...w(Y,L),...b(z,{numFriends:"numFriends",friends:"allFriends",groups:"allGroups",numGroups:"numGroups",friendData:"getFriendData"}),...b(k,["lg"]),groupCards(){let e=[];return this.groups.forEach(s=>{let t={groupId:s.id,groupName:s.group_name,groupCreated:s.created_at,groupUsers:[]};s.users.forEach(d=>{if(d!==this.userStore.id){let a=this.friendData(d);a&&t.groupUsers.push(a)}}),e.push(t)}),e}},methods:{...I(z,["createGroup","loadFriends"]),createGroupModalOpen(){this.newGroupName="",this.missingGroupName=!1,this.selectedFriendsForNewGroup=[],this.noFriendSelected=!1,this.showCreateGroupModal=!0,setTimeout(()=>{document.getElementById("new_group_name").focus()},500)},createGroupModalClose(){this.showCreateGroupModal=!1},clearNameError(){this.missingGroupName=!1},checkBoxChange(){this.noFriendSelected=!1},validateAndCreateGroup(){this.newGroupName.trim()==""&&(this.missingGroupName=!0,document.getElementById("new_group_name").focus()),this.selectedFriendsForNewGroup.length<1&&(this.noFriendSelected=!0),!(this.missingGroupName||this.noFriendSelected)&&(this.saveSuccess=!1,this.loadingStore.startLoading(),this.createGroup({groupName:this.newGroupName.trim(),friends:this.selectedFriendsForNewGroup}).then(()=>{this.loadFriends(),this.loadingStore.finishLoading(),this.createGroupModalClose(),this.saveSuccess=!0,setTimeout(()=>{this.saveSuccess=!1,this.toastMessage=""},3e3)}).catch(e=>{this.loadingStore.finishLoading(),this.createGroupModalClose(),e==401?this.$router.push("/login"):(this.saveError=!0,setTimeout(()=>{this.saveError=!1,this.toastMessage=""},3e3))}))}}},Rt={class:"friend-list-container"},vt={class:"friend-actions"},It={class:"contact-total"},kt={class:"friend-list"},yt={class:"friend-data"},Tt={class:"icon-edit-btn mr-1"},Ct={class:"btn-sm btn-primary"},wt={for:"new_group_name"},Ft={key:0,class:"text-danger"},Gt={class:"contact-total"},Et=["id","value"],Dt=["for"],Mt={key:0},Nt={key:0,class:"text-danger"},xt={class:"mt-2"};function zt(e,s,t,d,a,i){const m=h("ContactImage"),c=h("IconEdit"),v=h("Modal"),u=h("SuccessToast"),N=h("FailToast");return r(),o("div",Rt,[n("div",vt,[n("p",It,l(e.lg("friends_and_groups_count"))+" : "+l(e.numGroups),1),n("button",{class:"btn-sm btn-secondary",onClick:s[0]||(s[0]=(..._)=>i.createGroupModalOpen&&i.createGroupModalOpen(..._))},l(e.lg("create_group")),1)]),n("div",kt,[(r(!0),o(T,null,C(i.groupCards,_=>(r(),o("div",{key:_.groupId,class:"friend-wrapper mb-1"},[n("div",yt,[f(m,{friends:_.groupUsers},null,8,["friends"]),n("div",null,[n("h5",null,l(_.groupName),1)])]),n("div",null,[n("span",Tt,[f(c)]),n("button",Ct,l(e.lg("send_message")),1)])]))),128))]),f(v,{show:a.showCreateGroupModal,size:"lg",title:e.lg("create_group"),showFooter:!1,onClose:i.createGroupModalClose},{default:G(()=>[n("div",null,[n("div",null,[n("label",wt,l(e.lg("new_group_name_lbl")),1),E(n("input",{type:"text",id:"new_group_name",onInput:s[1]||(s[1]=(..._)=>i.clearNameError&&i.clearNameError(..._)),"onUpdate:modelValue":s[2]||(s[2]=_=>a.newGroupName=_)},null,544),[[U,a.newGroupName]]),a.missingGroupName?(r(),o("p",Ft,l(e.lg("new_group_name_missing")),1)):g("",!0)]),s[6]||(s[6]=n("hr",{class:"mt-2"},null,-1)),n("div",null,[n("p",Gt,l(e.lg("friends_count"))+" : "+l(e.numFriends),1),(r(!0),o(T,null,C(e.friends,_=>(r(),o("div",{key:"friends_"+_.friendId,class:"friend-checkbox"},[E(n("input",{type:"checkbox",id:"friend_"+_.friendId,value:_.friendId,onChange:s[3]||(s[3]=(...y)=>i.checkBoxChange&&i.checkBoxChange(...y)),"onUpdate:modelValue":s[4]||(s[4]=y=>a.selectedFriendsForNewGroup=y)},null,40,Et),[[j,a.selectedFriendsForNewGroup]]),n("label",{for:"friend_"+_.friendId},[f(m,{friends:[_]},null,8,["friends"]),S(" "+l(_.friendName)+" ",1),_.friendCity?(r(),o("span",Mt,"( "+l(_.friendCity)+" )",1)):g("",!0)],8,Dt)]))),128)),a.noFriendSelected?(r(),o("p",Nt,l(e.lg("no_friend_selected")),1)):g("",!0)]),n("div",xt,[n("button",{class:"btn btn-primary",onClick:s[5]||(s[5]=(..._)=>i.validateAndCreateGroup&&i.validateAndCreateGroup(..._))},l(e.lg("create_group")),1)])])]),_:1},8,["show","title","onClose"]),a.saveSuccess?(r(),R(u,{key:0})):g("",!0),a.saveError?(r(),R(N,{key:1})):g("",!0)])}const Lt=p(St,[["render",zt]]),Pt={components:{ContactTabs:$s,Contacts:Lt}},Bt={class:"mt-2"};function Ut(e,s,t,d,a,i){const m=h("ContactTabs"),c=h("Contacts");return r(),o("div",null,[n("div",null,[f(m)]),n("div",Bt,[f(c)])])}const At=p(Pt,[["render",Ut]]),Ot={components:{BaseLayout:Z,Home:At},props:["socket"]};function Ht(e,s,t,d,a,i){const m=h("Home"),c=h("BaseLayout");return r(),R(c,null,{default:G(()=>[f(m)]),_:1})}const Wt=p(Ot,[["render",Ht]]);export{Wt as default};
