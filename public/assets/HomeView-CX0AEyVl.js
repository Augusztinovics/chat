import{l as x,p as L,B as H}from"./BaseLayout-C0W7aZHm.js";import{I as z}from"./IconUser-DCrUtd-a.js";import{_ as m,x as d,g as o,h as t,d as M,f as b,e as p,z as I,u as v,i as c,t as l,w as C,k as S,o as f,l as E,v as D,s as g,m as F,A as V,F as P,B,q as y,C as K,n as T}from"./index-BfiHNWQR.js";import{M as $,I as j,F as J}from"./IconEdit-BYWwPPfK.js";const Q={},W={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function X(e,s){return d(),o("svg",W,s[0]||(s[0]=[t("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"},null,-1)]))}const G=m(Q,[["render",X]]),Y={},Z={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function ee(e,s){return d(),o("svg",Z,s[0]||(s[0]=[t("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},null,-1)]))}const se=m(Y,[["render",ee]]),te={},ne={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function ie(e,s){return d(),o("svg",ne,s[0]||(s[0]=[t("path",{d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"},null,-1)]))}const de=m(te,[["render",ie]]),k=M("requestSend",{state:()=>({loaded:!1,requests:[]}),getters:{numSendRequests:e=>e.requests.length??0,isLoaded:e=>e.loaded,sendRequests:e=>e.requests},actions:{loadRequests(){return new Promise((e,s)=>{b.get("/api/resources/sended-friend-requests").then(r=>{var u;this.requests=((u=r.data)==null?void 0:u.sendedRequests)??[],this.loaded=!0,e(!0)}).catch(r=>{r.response.status==401?s(401):s(r)})})},sendRequest(e){return new Promise((s,r)=>{b.post("/api/resources/friend-request-send",e).then(u=>{var i;this.requests=((i=u.data)==null?void 0:i.sendedRequests)??[],s(!0)}).catch(u=>{u.response.status==401?r(401):r(u)})})},cancelFrienRequest(e){return new Promise((s,r)=>{b.post("/api/resources/friend-request-delete",e).then(u=>{var i;this.requests=((i=u.data)==null?void 0:i.sendedRequests)??[],s(!0)}).catch(u=>{u.response.status==401?r(401):r(u)})})},editFriendRequest(e){return new Promise((s,r)=>{b.post("/api/resources/friend-request-edit",e).then(u=>{var i;this.requests=((i=u.data)==null?void 0:i.sendedRequests)??[],s(!0)}).catch(u=>{u.response.status==401?r(401):r(u)})})}}}),w=M("requestGet",{state:()=>({loaded:!1,requests:[]}),getters:{numGetRequests:e=>e.requests.length??0,isLoaded:e=>e.loaded},actions:{loadRequests(){return new Promise((e,s)=>{setTimeout(()=>{this.loaded=!0,e(!0)},300)})},acceptRequest(e){return new Promise((s,r)=>{console.log(e),setTimeout(()=>{s(!0)},1e3)})}}}),re={props:{friend:{type:Object,default(e){return{friendId:null,friendName:"",friendDescription:"",friendCountry:"",friendCity:"",friendImg:null,reqId:null,reqAcceptedDate:null,sendId:null,sendAcceptedDate:null,messageToFriend:"",messageFromFriend:""}}}},components:{IconUser:z,Modal:$,IconEdit:j},data(){return{showDetails:!1,sending:!1,showRequestModal:!1,requestText:"",editing:!1}},computed:{...p(v,["lg"]),hasFriend(){return this.friend.friendId!=null},isFriend(){return this.friend.reqId&&this.friend.reqAcceptedDate||this.friend.sendId&&this.friend.sendAcceptedDate},isReqGet(){return this.friend.reqId&&!this.friend.reqAcceptedDate},isReqSend(){return this.friend.sendId&&!this.friend.sendAcceptedDate}},methods:{...I(k,["sendRequest","cancelFrienRequest","editFriendRequest"]),...I(w,["acceptRequest"]),modalClose(){this.showDetails=!1},openModal(){this.showDetails=!0},openRequestModal(){this.requestText="",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus()},300)},sendFriendRequest(){this.editing?(this.showRequestModal=!1,this.sending=!0,this.editFriendRequest({requestId:this.friend.sendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.friend.messageToFriend=this.requestText,this.editing=!1,this.showDetails=!0}).catch(e=>{this.sending=!1,this.editing=!1,e==401&&this.$router.push("/login")})):(this.showRequestModal=!1,this.sending=!0,this.sendRequest({friendId:this.friend.friendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.friend.messageToFriend=this.requestText,this.requestText="",this.friend.sendId=1}).catch(e=>{this.sending=!1,e==401&&this.$router.push("/login")}))},acceptFriendRequest(){this.sending=!0,this.acceptRequest({friendId:this.friend.friendId,reqId:this.friend.reqId}).then(()=>{this.sending=!1,this.friend.reqAcceptedDate=!0}).catch(e=>{this.sending=!1,e==401&&this.$router.push("/login")})},denieFriendRequest(){},cancelRequest(){this.friend.sendId!=1&&(this.sending=!0,this.cancelFrienRequest({requestId:this.friend.sendId}).then(()=>{this.sending=!1,this.friend.messageToFriend="",this.friend.sendId=null}).catch(e=>{this.sending=!1,e==401&&this.$router.push("/login")}))},editRequestMessage(){this.showDetails=!1,this.editing=!0,this.requestText=this.friend.messageToFriend??"",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus().select()},300)},sendMessage(){}}},oe={key:0,class:"friend-card"},ae={class:"friend-card-img"},le=["src"],ue={key:1,class:"icon-lg"},ce={class:"friend-card-action"},he=["disabled"],ge={key:1},_e=["disabled"],fe=["disabled"],me={key:2},pe=["disabled"],qe=["disabled"],be={class:"text-left"},Se={class:"text-center mt-1 mb-2"},Re=["src"],Te={key:1,class:"icon-lg"},Ie={class:"friend-modal-des"},ye={class:"text-bold"},ke={class:"text-bold"},ve={class:"text-bold"},Ce={class:"mb-2"},we={key:0},Fe={key:0},xe={key:1},Le=["disabled"],ze=["disabled"],Me={key:1},Ee={key:0},De={key:1},Pe={class:"request-modal-body"},Be={for:"request_text_input_field"};function Ge(e,s,r,u,i,n){const _=g("IconUser"),h=g("IconEdit"),q=g("Modal");return n.hasFriend?(d(),o("div",oe,[t("div",ae,[r.friend.friendImg?(d(),o("img",{key:0,src:r.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,le)):(d(),o("span",ue,[c(_)]))]),t("div",{class:"friend-card-name",onClick:s[0]||(s[0]=(...a)=>n.openModal&&n.openModal(...a))},[t("h5",null,l(r.friend.friendName),1)]),t("div",ce,[n.isFriend?(d(),o("button",{key:0,class:"btn-sm btn-primary",onClick:s[1]||(s[1]=(...a)=>n.sendMessage&&n.sendMessage(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("send_message")),9,he)):n.isReqGet?(d(),o("div",ge,[t("button",{class:"btn-sm btn-primary",onClick:s[2]||(s[2]=(...a)=>n.acceptFriendRequest&&n.acceptFriendRequest(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("accept_request")),9,_e),t("button",{class:"btn-sm btn-danger",onClick:s[3]||(s[3]=(...a)=>n.denieFriendRequest&&n.denieFriendRequest(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("denie_request")),9,fe)])):n.isReqSend?(d(),o("div",me,[t("p",null,l(e.lg("already_send")),1),t("button",{class:"btn-sm btn-danger",onClick:s[4]||(s[4]=(...a)=>n.cancelRequest&&n.cancelRequest(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("cancel_request")),9,pe)])):(d(),o("button",{key:3,class:"btn-sm btn-primary",onClick:s[5]||(s[5]=(...a)=>n.openRequestModal&&n.openRequestModal(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("send_request")),9,qe))]),c(q,{show:i.showDetails,size:"md",title:r.friend.friendName,headerClass:"text-left",showFooter:!1,onClose:n.modalClose},{default:C(()=>[t("div",be,[t("div",Se,[r.friend.friendImg?(d(),o("img",{key:0,src:r.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,Re)):(d(),o("span",Te,[c(_)]))]),t("div",Ie,[t("p",null,[t("span",ye,l(e.lg("city"))+" :",1),S(l(r.friend.friendCity??"????"),1)]),t("p",null,[t("span",ke,l(e.lg("friend_country"))+" :",1),S(l(r.friend.friendCountry??"????"),1)]),t("p",null,[t("span",ve,l(e.lg("friend_des")),1)]),t("p",Ce,l(r.friend.friendDescription??"??????"),1),n.isReqGet?(d(),o("div",we,[s[12]||(s[12]=t("p",null,"Friend say",-1)),r.friend.messageFromFriend?(d(),o("p",Fe,l(r.friend.messageFromFriend),1)):(d(),o("p",xe,"Dont say anything")),t("div",null,[t("button",{class:"btn-sm btn-primary",onClick:s[6]||(s[6]=(...a)=>n.acceptFriendRequest&&n.acceptFriendRequest(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("accept_request")),9,Le),t("button",{class:"btn-sm btn-danger",onClick:s[7]||(s[7]=(...a)=>n.denieFriendRequest&&n.denieFriendRequest(...a)),disabled:i.sending},l(i.sending?e.lg("sending"):e.lg("denie_request")),9,ze)])])):f("",!0),n.isReqSend?(d(),o("div",Me,[t("p",null,l(e.lg("you_request_text")),1),r.friend.messageToFriend?(d(),o("p",Ee,l(r.friend.messageToFriend),1)):(d(),o("p",De,l(e.lg("no_request_send_text")),1)),t("p",null,[t("span",{class:"icon-edit-btn",onClick:s[8]||(s[8]=(...a)=>n.editRequestMessage&&n.editRequestMessage(...a))},[c(h)])])])):f("",!0)])])]),_:1},8,["show","title","onClose"]),c(q,{show:i.showRequestModal,size:"sm",title:e.lg("send_request"),headerClass:"text-left",showCancel:!0,cancelBtnText:e.lg("cancel"),okBtnText:e.lg("send"),onClose:s[10]||(s[10]=a=>i.showRequestModal=!1),onCancel:s[11]||(s[11]=a=>i.showRequestModal=!1),onOk:n.sendFriendRequest},{default:C(()=>[t("div",Pe,[t("p",null,[S(l(e.lg("addresse"))+" ",1),t("span",null,l(r.friend.friendName),1)]),t("label",Be,l(e.lg("few_words")),1),E(t("textarea",{name:"requestText",id:"request_text_input_field","onUpdate:modelValue":s[9]||(s[9]=a=>i.requestText=a)},null,512),[[D,i.requestText]])])]),_:1},8,["show","title","cancelBtnText","okBtnText","onOk"])])):f("",!0)}const N=m(re,[["render",Ge]]),Ne={components:{IconSearch:G,FailToast:J,FriendCard:N},data(){return{submitting:!1,searchText:"",firstSearch:!0,searchResult:[],searchError:!1,paginationIndex:0}},computed:{...p(v,["lg"]),...F(L,x),hasSearchResult(){return this.searchResult.length>0},hasPagination(){return this.searchResult.length>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.searchResult.length},cardsToShow(){let e=[];if(!this.hasSearchResult)return e;let s=this.paginationIndex*this.paginationSizesStore.topSize;s>this.searchResult.length-1&&(s=this.searchResult.length-1),this.paginationSizesStore.topSize>=this.searchResult.length&&(s=0);let r=s+this.paginationSizesStore.topSize;r>this.searchResult.length&&(r=this.searchResult.length);for(let u=s;u<r;u++)e.push(this.searchResult[u]);return e}},methods:{searchUsers(){this.searchText.trim()!=""&&(this.firstSearch=!1,this.submitting=!0,this.loadingStore.startLoading(),this.searchError=!1,b.get("/api/resources/search-user?un="+this.searchText.trim()).then(e=>{this.submitting=!1,this.loadingStore.finishLoading(),this.searchResult=e.data.users}).catch(e=>{this.submitting=!1,this.loadingStore.finishLoading(),this.searchError=!0,setTimeout(()=>{this.searchError=!1},3e3),console.log(e)}))},paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++}},mounted(){this.submitting=!1,this.searchText="",this.firstSearch=!0,document.getElementById("search_input").focus()}},Ae={class:"search-menu"},Ue={class:"user-search-input"},Oe={for:"search_input"},He={class:"password-container"},Ve=["disabled"],Ke=["disabled"],$e={class:"icon"},je={key:0,class:"search-result-holder"},Je={class:"results"},Qe={key:0},We=["disabled"],Xe={class:"result-cards"},Ye={key:1},Ze=["disabled"],es={key:1,class:"search-result-no-result-holder"},ss={key:0},ts={key:1};function ns(e,s,r,u,i,n){const _=g("IconSearch"),h=g("FriendCard"),q=g("FailToast");return d(),o("div",null,[t("div",Ae,[t("div",Ue,[t("label",Oe,l(e.lg("user_search")),1),t("div",He,[E(t("input",{id:"search_input",type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>i.searchText=a),disabled:i.submitting,onKeypress:s[1]||(s[1]=V((...a)=>n.searchUsers&&n.searchUsers(...a),["enter"]))},null,40,Ve),[[D,i.searchText]]),t("button",{type:"button",onClick:s[2]||(s[2]=(...a)=>n.searchUsers&&n.searchUsers(...a)),disabled:i.submitting},[t("span",$e,[c(_)])],8,Ke)])])]),t("div",null,[n.hasSearchResult?(d(),o("div",je,[t("p",null,[t("span",null,l(i.searchResult.length),1),s[5]||(s[5]=S()),t("span",null,l(e.lg("results")),1)]),t("div",Je,[n.hasPagination?(d(),o("div",Qe,[t("button",{type:"button",disabled:i.paginationIndex==0,class:"pag-btn",onClick:s[3]||(s[3]=(...a)=>n.paginateLeft&&n.paginateLeft(...a))},"<",8,We)])):f("",!0),t("div",Xe,[(d(!0),o(P,null,B(n.cardsToShow,a=>(d(),y(h,{key:"friend_"+a.friendId,friend:a},null,8,["friend"]))),128))]),n.hasPagination?(d(),o("div",Ye,[t("button",{type:"button",disabled:n.rightPaginationDisabled,class:"pag-btn",onClick:s[4]||(s[4]=(...a)=>n.paginateRight&&n.paginateRight(...a))},">",8,Ze)])):f("",!0)])])):(d(),o("div",es,[i.firstSearch?(d(),o("p",ss,l(e.lg("user_search_before")),1)):(d(),o("p",ts,l(e.lg("user_search_not_find")),1))]))]),i.searchError?(d(),y(q,{key:0})):f("",!0)])}const is=m(Ne,[["render",ns]]),ds={components:{FriendCard:N},data(){return{paginationIndex:0}},computed:{...p(v,["lg"]),...p(k,["numSendRequests","sendRequests"]),...F(L),hasPagination(){return this.numSendRequests>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.numSendRequests},cardsToShow(){let e=[];if(this.numSendRequests<1)return e;let s=this.paginationIndex*this.paginationSizesStore.topSize;s>this.sendRequests.length-1&&(s=this.sendRequests.length-1),this.paginationSizesStore.topSize>=this.sendRequests.length&&(s=0);let r=s+this.paginationSizesStore.topSize;r>this.sendRequests.length&&(r=this.sendRequests.length);for(let u=s;u<r;u++)e.push(this.sendRequests[u]);return e}},methods:{paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++},changeTabToSearch(){this.$emit("changeTab")}}},rs={key:0,class:"search-result-holder"},os={class:"results"},as={key:0},ls=["disabled"],us={class:"result-cards"},cs={key:1},hs=["disabled"],gs={key:1,class:"text-center m-2"};function _s(e,s,r,u,i,n){const _=g("FriendCard");return d(),o("div",null,[e.numSendRequests?(d(),o("div",rs,[t("div",os,[n.hasPagination?(d(),o("div",as,[t("button",{type:"button",disabled:i.paginationIndex==0,class:"pag-btn",onClick:s[0]||(s[0]=(...h)=>n.paginateLeft&&n.paginateLeft(...h))},"<",8,ls)])):f("",!0),t("div",us,[(d(!0),o(P,null,B(n.cardsToShow,h=>(d(),y(_,{key:"send__request_"+h.friendId,friend:h},null,8,["friend"]))),128))]),n.hasPagination?(d(),o("div",cs,[t("button",{type:"button",disabled:n.rightPaginationDisabled,class:"pag-btn",onClick:s[1]||(s[1]=(...h)=>n.paginateRight&&n.paginateRight(...h))},">",8,hs)])):f("",!0)])])):(d(),o("div",gs,[t("p",null,[S(l(e.lg("not_send_any_request_yet"))+" ",1),t("span",{class:"btn-link",onClick:s[2]||(s[2]=(...h)=>n.changeTabToSearch&&n.changeTabToSearch(...h))},l(e.lg("contact_search")),1)])]))])}const fs=m(ds,[["render",_s]]),ms={components:{IconUser:z,IconEarth:K,IconSearch:G,IconLeft:se,IconRight:de,SearchContactTab:is,SendRequestsTab:fs},data(){return{selectedTab:"SOME"}},computed:{...F(x),...p(v,["lg"]),...p(k,{numSendRequests:"numSendRequests",isSendStoreLoaded:"isLoaded"}),...p(w,{numGetRequests:"numGetRequests",isGetStoreLoaded:"isLoaded"})},methods:{...I(k,{loadSendRequests:"loadRequests"}),...I(w,{loadGetRequests:"loadRequests"}),selectTab(e){e==this.selectedTab?this.selectedTab="NONE":this.selectedTab=e},loadStores(){let e=[];this.isSendStoreLoaded||e.push(this.loadSendRequests()),this.isGetStoreLoaded||e.push(this.loadGetRequests()),this.loadingStore.startLoading(),Promise.all(e).then(()=>{this.loadingStore.finishLoading()}).catch(s=>{this.loadingStore.finishLoading(),s==401&&this.$router.push("/login")})}},mounted(){this.loadStores()}},ps={class:"contact-tabs"},qs={class:"tab"},bs={class:"icon"},Ss={class:"icon"},Rs={class:"tab-text"},Ts={class:"icon"},Is={class:"icon"},ys={class:"tab-text"},ks={class:"icon"},vs={class:"icon"},Cs={class:"tab-text"},ws={key:0,class:"tab-num"},Fs={class:"icon"},xs={class:"icon"},Ls={class:"tab-text"},zs={key:0,class:"tab-num"},Ms={key:0,class:"tab-content"},Es={key:0},Ds={key:1},Ps={key:2},Bs={key:3};function Gs(e,s,r,u,i,n){const _=g("IconUser"),h=g("IconEarth"),q=g("IconSearch"),a=g("IconLeft"),A=g("IconRight"),U=g("SearchContactTab"),O=g("SendRequestsTab");return d(),o("div",ps,[t("div",qs,[t("span",{class:T(["tab-menu",{"active-tab":i.selectedTab=="SOME"}]),onClick:s[0]||(s[0]=R=>n.selectTab("SOME"))},[t("span",bs,[c(_)]),t("span",Ss,[c(h)]),t("span",Rs,l(e.lg("who_can_know")),1)],2),t("span",{class:T(["tab-menu",{"active-tab":i.selectedTab=="SEARCH"}]),onClick:s[1]||(s[1]=R=>n.selectTab("SEARCH"))},[t("span",Ts,[c(_)]),t("span",Is,[c(q)]),t("span",ys,l(e.lg("contact_search")),1)],2),t("span",{class:T(["tab-menu",{"active-tab":i.selectedTab=="GET"}]),onClick:s[2]||(s[2]=R=>n.selectTab("GET"))},[t("span",ks,[c(_)]),t("span",vs,[c(a)]),t("span",Cs,l(e.lg("friend_requests")),1),e.numGetRequests?(d(),o("sup",ws,l(e.numGetRequests),1)):f("",!0)],2),t("span",{class:T(["tab-menu",{"active-tab":i.selectedTab=="SEND"}]),onClick:s[3]||(s[3]=R=>n.selectTab("SEND"))},[t("span",Fs,[c(_)]),t("span",xs,[c(A)]),t("span",Ls,l(e.lg("send_requests")),1),e.numSendRequests?(d(),o("sup",zs,l(e.numSendRequests),1)):f("",!0)],2)]),i.selectedTab!="NONE"?(d(),o("div",Ms,[i.selectedTab=="SOME"?(d(),o("div",Es,"Ajanlas")):f("",!0),i.selectedTab=="SEARCH"?(d(),o("div",Ds,[c(U)])):f("",!0),i.selectedTab=="GET"?(d(),o("div",Ps,"Kapottak")):f("",!0),i.selectedTab=="SEND"?(d(),o("div",Bs,[c(O,{onChangeTab:s[4]||(s[4]=R=>n.selectTab("SEARCH"))})])):f("",!0)])):f("",!0)])}const Ns=m(ms,[["render",Gs]]),As={};function Us(e,s,r,u,i,n){return d(),o("div",null," contacts ")}const Os=m(As,[["render",Us]]),Hs={components:{ContactTabs:Ns,Contacts:Os}},Vs={class:"mt-2"};function Ks(e,s,r,u,i,n){const _=g("ContactTabs"),h=g("Contacts");return d(),o("div",null,[t("div",null,[c(_)]),t("div",Vs,[c(h)])])}const $s=m(Hs,[["render",Ks]]),js={components:{BaseLayout:H,Home:$s},props:["socket"]};function Js(e,s,r,u,i,n){const _=g("Home"),h=g("BaseLayout");return d(),y(h,null,{default:C(()=>[c(_)]),_:1})}const Zs=m(js,[["render",Js]]);export{Zs as default};
