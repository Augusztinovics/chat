import{L as z,p as L,B}from"./BaseLayout-DVSMzMoj.js";import{I as C}from"./IconUser-BE6y1_bR.js";import{_ as p,x as d,g as o,h as s,d as F,f as q,e as S,z as w,u as k,i as u,t as a,w as y,k as T,o as f,l as x,v as M,s as h,m as N,A as P,F as A,B as O,q as I,C as U,n as R}from"./index-CaNqESJU.js";import{M as G,I as H,F as V}from"./IconEdit-CWFUjo7h.js";const K={},j={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function J(t,e){return d(),o("svg",j,e[0]||(e[0]=[s("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"},null,-1)]))}const E=p(K,[["render",J]]),Q={},W={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function X(t,e){return d(),o("svg",W,e[0]||(e[0]=[s("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},null,-1)]))}const Y=p(Q,[["render",X]]),Z={},$={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function ee(t,e){return d(),o("svg",$,e[0]||(e[0]=[s("path",{d:"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"},null,-1)]))}const se=p(Z,[["render",ee]]),te=F("requestSend",{state:()=>({requests:[]}),actions:{loadRequests(){return new Promise((t,e)=>{q.get("/api/resources/sended-friend-requests").then(r=>{var l;this.requests=((l=r.data)==null?void 0:l.sendedRequests)??[],t(!0)}).catch(r=>{r.response.status==401?e(401):e(r)})})},sendRequest(t){return new Promise((e,r)=>{q.post("/api/resources/friend-request-send",t).then(l=>{var n;this.requests=((n=l.data)==null?void 0:n.sendedRequests)??[],e(!0)}).catch(l=>{l.response.status==401?r(401):r(l)})})},cancelFrienRequest(t){return new Promise((e,r)=>{q.post("/api/resources/friend-request-delete",t).then(l=>{var n;this.requests=((n=l.data)==null?void 0:n.sendedRequests)??[],e(!0)}).catch(l=>{l.response.status==401?r(401):r(l)})})},editFriendRequest(t){return new Promise((e,r)=>{q.post("/api/resources/friend-request-edit",t).then(l=>{var n;this.requests=((n=l.data)==null?void 0:n.sendedRequests)??[],e(!0)}).catch(l=>{l.response.status==401?r(401):r(l)})})}}}),ne=F("requestGet",{state:()=>({requests:[]}),actions:{loadRequests(){return new Promise((t,e)=>{})},acceptRequest(t){return new Promise((e,r)=>{console.log(t),setTimeout(()=>{e(!0)},1e3)})}}}),ie={props:{friend:{type:Object,default(t){return{friendId:null,friendName:"",friendDescription:"",friendCountry:"",friendCity:"",friendImg:null,reqId:null,reqAcceptedDate:null,sendId:null,sendAcceptedDate:null,messageToFriend:"",messageFromFriend:""}}}},components:{IconUser:C,Modal:G,IconEdit:H},data(){return{showDetails:!1,sending:!1,showRequestModal:!1,requestText:"",editing:!1}},computed:{...S(k,["lg"]),hasFriend(){return this.friend.friendId!=null},isFriend(){return this.friend.reqId&&this.friend.reqAcceptedDate||this.friend.sendId&&this.friend.sendAcceptedDate},isReqGet(){return this.friend.reqId&&!this.friend.reqAcceptedDate},isReqSend(){return this.friend.sendId&&!this.friend.sendAcceptedDate}},methods:{...w(te,["sendRequest","cancelFrienRequest","editFriendRequest"]),...w(ne,["acceptRequest"]),modalClose(){this.showDetails=!1},openModal(){this.showDetails=!0},openRequestModal(){this.requestText="",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus()},300)},sendFriendRequest(){this.editing?(this.showRequestModal=!1,this.sending=!0,this.editFriendRequest({requestId:this.friend.sendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.friend.messageToFriend=this.requestText,this.editing=!1,this.showDetails=!0}).catch(()=>{this.sending=!1,this.editing=!1})):(this.showRequestModal=!1,this.sending=!0,this.sendRequest({friendId:this.friend.friendId,text:this.requestText.trim()}).then(()=>{this.sending=!1,this.friend.messageToFriend=this.requestText,this.requestText="",this.friend.sendId=1}).catch(()=>{this.sending=!1}))},acceptFriendRequest(){this.sending=!0,this.acceptRequest({friendId:this.friend.friendId,reqId:this.friend.reqId}).then(()=>{this.sending=!1,this.friend.reqAcceptedDate=!0}).catch(()=>{this.sending=!1})},denieFriendRequest(){},cancelRequest(){this.friend.sendId!=1&&(this.sending=!0,this.cancelFrienRequest({requestId:this.friend.sendId}).then(()=>{this.sending=!1,this.friend.messageToFriend="",this.friend.sendId=null}).catch(()=>{this.sending=!1}))},editRequestMessage(){this.showDetails=!1,this.editing=!0,this.requestText=this.friend.messageToFriend??"",this.showRequestModal=!0,setTimeout(()=>{document.getElementById("request_text_input_field").focus().select()},300)},sendMessage(){}}},re={key:0,class:"friend-card"},de={class:"friend-card-img"},oe=["src"],ae={key:1,class:"icon-lg"},le={class:"friend-card-action"},ce=["disabled"],ue={key:1},he=["disabled"],_e=["disabled"],ge={key:2},fe=["disabled"],me=["disabled"],pe={class:"text-left"},be={class:"text-center mt-1 mb-2"},qe=["src"],Re={key:1,class:"icon-lg"},Te={class:"friend-modal-des"},Ie={class:"text-bold"},ve={class:"text-bold"},ye={class:"text-bold"},Se={class:"mb-2"},ke={key:0},we={key:0},Ce={key:1},Fe=["disabled"],xe=["disabled"],Me={key:1},Ee={key:0},De={key:1},ze={class:"request-modal-body"},Le={for:"request_text_input_field"};function Be(t,e,r,l,n,i){const g=h("IconUser"),m=h("IconEdit"),b=h("Modal");return i.hasFriend?(d(),o("div",re,[s("div",de,[r.friend.friendImg?(d(),o("img",{key:0,src:r.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,oe)):(d(),o("span",ae,[u(g)]))]),s("div",{class:"friend-card-name",onClick:e[0]||(e[0]=(...c)=>i.openModal&&i.openModal(...c))},[s("h5",null,a(r.friend.friendName),1)]),s("div",le,[i.isFriend?(d(),o("button",{key:0,class:"btn-sm btn-primary",onClick:e[1]||(e[1]=(...c)=>i.sendMessage&&i.sendMessage(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("send_message")),9,ce)):i.isReqGet?(d(),o("div",ue,[s("button",{class:"btn-sm btn-primary",onClick:e[2]||(e[2]=(...c)=>i.acceptFriendRequest&&i.acceptFriendRequest(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("accept_request")),9,he),s("button",{class:"btn-sm btn-danger",onClick:e[3]||(e[3]=(...c)=>i.denieFriendRequest&&i.denieFriendRequest(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("denie_request")),9,_e)])):i.isReqSend?(d(),o("div",ge,[s("p",null,a(t.lg("already_send")),1),s("button",{class:"btn-sm btn-danger",onClick:e[4]||(e[4]=(...c)=>i.cancelRequest&&i.cancelRequest(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("cancel_request")),9,fe)])):(d(),o("button",{key:3,class:"btn-sm btn-primary",onClick:e[5]||(e[5]=(...c)=>i.openRequestModal&&i.openRequestModal(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("send_request")),9,me))]),u(b,{show:n.showDetails,size:"md",title:r.friend.friendName,headerClass:"text-left",showFooter:!1,onClose:i.modalClose},{default:y(()=>[s("div",pe,[s("div",be,[r.friend.friendImg?(d(),o("img",{key:0,src:r.friend.friendImg,alt:"Profile Image",class:"profile-img md"},null,8,qe)):(d(),o("span",Re,[u(g)]))]),s("div",Te,[s("p",null,[s("span",Ie,a(t.lg("city"))+" :",1),T(a(r.friend.friendCity??"????"),1)]),s("p",null,[s("span",ve,a(t.lg("friend_country"))+" :",1),T(a(r.friend.friendCountry??"????"),1)]),s("p",null,[s("span",ye,a(t.lg("friend_des")),1)]),s("p",Se,a(r.friend.friendDescription??"??????"),1),i.isReqGet?(d(),o("div",ke,[e[12]||(e[12]=s("p",null,"Friend say",-1)),r.friend.messageFromFriend?(d(),o("p",we,a(r.friend.messageFromFriend),1)):(d(),o("p",Ce,"Dont say anything")),s("div",null,[s("button",{class:"btn-sm btn-primary",onClick:e[6]||(e[6]=(...c)=>i.acceptFriendRequest&&i.acceptFriendRequest(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("accept_request")),9,Fe),s("button",{class:"btn-sm btn-danger",onClick:e[7]||(e[7]=(...c)=>i.denieFriendRequest&&i.denieFriendRequest(...c)),disabled:n.sending},a(n.sending?t.lg("sending"):t.lg("denie_request")),9,xe)])])):f("",!0),i.isReqSend?(d(),o("div",Me,[s("p",null,a(t.lg("you_request_text")),1),r.friend.messageToFriend?(d(),o("p",Ee,a(r.friend.messageToFriend),1)):(d(),o("p",De,a(t.lg("no_request_send_text")),1)),s("p",null,[s("span",{class:"icon-edit-btn",onClick:e[8]||(e[8]=(...c)=>i.editRequestMessage&&i.editRequestMessage(...c))},[u(m)])])])):f("",!0)])])]),_:1},8,["show","title","onClose"]),u(b,{show:n.showRequestModal,size:"sm",title:t.lg("send_request"),headerClass:"text-left",showCancel:!0,cancelBtnText:t.lg("cancel"),okBtnText:t.lg("send"),onClose:e[10]||(e[10]=c=>n.showRequestModal=!1),onCancel:e[11]||(e[11]=c=>n.showRequestModal=!1),onOk:i.sendFriendRequest},{default:y(()=>[s("div",ze,[s("p",null,[T(a(t.lg("addresse"))+" ",1),s("span",null,a(r.friend.friendName),1)]),s("label",Le,a(t.lg("few_words")),1),x(s("textarea",{name:"requestText",id:"request_text_input_field","onUpdate:modelValue":e[9]||(e[9]=c=>n.requestText=c)},null,512),[[M,n.requestText]])])]),_:1},8,["show","title","cancelBtnText","okBtnText","onOk"])])):f("",!0)}const Ne=p(ie,[["render",Be]]),Pe={components:{IconSearch:E,LoadingOverlay:z,FailToast:V,FriendCard:Ne},data(){return{submitting:!1,searchText:"",firstSearch:!0,searchResult:[],searchError:!1,paginationIndex:0}},computed:{...S(k,["lg"]),...N(L),hasSearchResult(){return this.searchResult.length>0},hasPagination(){return this.searchResult.length>this.paginationSizesStore.topSize},rightPaginationDisabled(){return this.paginationIndex*this.paginationSizesStore.topSize+this.paginationSizesStore.topSize>=this.searchResult.length},cardsToShow(){let t=[];if(!this.hasSearchResult)return t;let e=this.paginationIndex*this.paginationSizesStore.topSize;e>this.searchResult.length-1&&(e=this.searchResult.length-1),this.paginationSizesStore.topSize>=this.searchResult.length&&(e=0);let r=e+this.paginationSizesStore.topSize;r>this.searchResult.length&&(r=this.searchResult.length);for(let l=e;l<r;l++)t.push(this.searchResult[l]);return t}},methods:{searchUsers(){this.searchText.trim()!=""&&(this.firstSearch=!1,this.submitting=!0,this.searchError=!1,q.get("/api/resources/search-user?un="+this.searchText.trim()).then(t=>{this.submitting=!1,this.searchResult=t.data.users}).catch(t=>{this.submitting=!1,this.searchError=!0,setTimeout(()=>{this.searchError=!1},3e3),console.log(t)}))},paginateLeft(){this.paginationIndex--},paginateRight(){this.paginationIndex++}},mounted(){this.submitting=!1,this.searchText="",this.firstSearch=!0,document.getElementById("search_input").focus()}},Ae={class:"search-menu"},Oe={class:"user-search-input"},Ue={for:"search_input"},Ge={class:"password-container"},He=["disabled"],Ve=["disabled"],Ke={class:"icon"},je={key:0,class:"search-result-holder"},Je={class:"results"},Qe={key:0},We=["disabled"],Xe={class:"result-cards"},Ye={key:1},Ze=["disabled"],$e={key:1,class:"search-result-no-result-holder"},es={key:0},ss={key:1};function ts(t,e,r,l,n,i){const g=h("IconSearch"),m=h("FriendCard"),b=h("LoadingOverlay"),c=h("FailToast");return d(),o("div",null,[s("div",Ae,[s("div",Oe,[s("label",Ue,a(t.lg("user_search")),1),s("div",Ge,[x(s("input",{id:"search_input",type:"text","onUpdate:modelValue":e[0]||(e[0]=_=>n.searchText=_),disabled:n.submitting,onKeypress:e[1]||(e[1]=P((..._)=>i.searchUsers&&i.searchUsers(..._),["enter"]))},null,40,He),[[M,n.searchText]]),s("button",{type:"button",onClick:e[2]||(e[2]=(..._)=>i.searchUsers&&i.searchUsers(..._)),disabled:n.submitting},[s("span",Ke,[u(g)])],8,Ve)])])]),s("div",null,[i.hasSearchResult?(d(),o("div",je,[s("p",null,[s("span",null,a(n.searchResult.length),1),e[5]||(e[5]=T()),s("span",null,a(t.lg("results")),1)]),s("div",Je,[i.hasPagination?(d(),o("div",Qe,[s("button",{type:"button",disabled:n.paginationIndex==0,class:"pag-btn",onClick:e[3]||(e[3]=(..._)=>i.paginateLeft&&i.paginateLeft(..._))},"<",8,We)])):f("",!0),s("div",Xe,[(d(!0),o(A,null,O(i.cardsToShow,_=>(d(),I(m,{key:"friend_"+_.friendId,friend:_},null,8,["friend"]))),128))]),i.hasPagination?(d(),o("div",Ye,[s("button",{type:"button",disabled:i.rightPaginationDisabled,class:"pag-btn",onClick:e[4]||(e[4]=(..._)=>i.paginateRight&&i.paginateRight(..._))},">",8,Ze)])):f("",!0)])])):(d(),o("div",$e,[n.firstSearch?(d(),o("p",es,a(t.lg("user_search_before")),1)):(d(),o("p",ss,a(t.lg("user_search_not_find")),1))]))]),n.submitting?(d(),I(b,{key:0})):f("",!0),n.searchError?(d(),I(c,{key:1})):f("",!0)])}const ns=p(Pe,[["render",ts]]),is={components:{IconUser:C,IconEarth:U,IconSearch:E,IconLeft:Y,IconRight:se,SearchContactTab:ns},data(){return{selectedTab:"SOME"}},computed:{...S(k,["lg"])},methods:{selectTab(t){t==this.selectedTab?this.selectedTab="NONE":this.selectedTab=t}}},rs={class:"contact-tabs"},ds={class:"tab"},os={class:"icon"},as={class:"icon"},ls={class:"tab-text"},cs={class:"icon"},us={class:"icon"},hs={class:"tab-text"},_s={class:"icon"},gs={class:"icon"},fs={class:"tab-text"},ms={class:"icon"},ps={class:"icon"},bs={class:"tab-text"},qs={key:0,class:"tab-content"},Rs={key:0},Ts={key:1},Is={key:2},vs={key:3};function ys(t,e,r,l,n,i){const g=h("IconUser"),m=h("IconEarth"),b=h("IconSearch"),c=h("IconLeft"),_=h("IconRight"),D=h("SearchContactTab");return d(),o("div",rs,[s("div",ds,[s("span",{class:R(["tab-menu",{"active-tab":n.selectedTab=="SOME"}]),onClick:e[0]||(e[0]=v=>i.selectTab("SOME"))},[s("span",os,[u(g)]),s("span",as,[u(m)]),s("span",ls,a(t.lg("who_can_know")),1)],2),s("span",{class:R(["tab-menu",{"active-tab":n.selectedTab=="SEARCH"}]),onClick:e[1]||(e[1]=v=>i.selectTab("SEARCH"))},[s("span",cs,[u(g)]),s("span",us,[u(b)]),s("span",hs,a(t.lg("contact_search")),1)],2),s("span",{class:R(["tab-menu",{"active-tab":n.selectedTab=="GET"}]),onClick:e[2]||(e[2]=v=>i.selectTab("GET"))},[s("span",_s,[u(g)]),s("span",gs,[u(c)]),s("span",fs,a(t.lg("friend_requests")),1)],2),s("span",{class:R(["tab-menu",{"active-tab":n.selectedTab=="SEND"}]),onClick:e[3]||(e[3]=v=>i.selectTab("SEND"))},[s("span",ms,[u(g)]),s("span",ps,[u(_)]),s("span",bs,a(t.lg("send_requests")),1)],2)]),n.selectedTab!="NONE"?(d(),o("div",qs,[n.selectedTab=="SOME"?(d(),o("div",Rs,"Ajanlas")):f("",!0),n.selectedTab=="SEARCH"?(d(),o("div",Ts,[u(D)])):f("",!0),n.selectedTab=="GET"?(d(),o("div",Is,"Kapottak")):f("",!0),n.selectedTab=="SEND"?(d(),o("div",vs,"Elkuldtem, de hun a valasz")):f("",!0)])):f("",!0)])}const Ss=p(is,[["render",ys]]),ks={};function ws(t,e,r,l,n,i){return d(),o("div",null," contacts ")}const Cs=p(ks,[["render",ws]]),Fs={components:{ContactTabs:Ss,Contacts:Cs}},xs={class:"mt-2"};function Ms(t,e,r,l,n,i){const g=h("ContactTabs"),m=h("Contacts");return d(),o("div",null,[s("div",null,[u(g)]),s("div",xs,[u(m)])])}const Es=p(Fs,[["render",Ms]]),Ds={components:{BaseLayout:B,Home:Es},props:["socket"]};function zs(t,e,r,l,n,i){const g=h("Home"),m=h("BaseLayout");return d(),I(m,null,{default:y(()=>[u(g)]),_:1})}const As=p(Ds,[["render",zs]]);export{As as default};
